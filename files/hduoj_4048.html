<!DOCTYPE html><html>
				<head><meta charset=gb2312 />
				<link rel="stylesheet" type=text/css href="../style.css" />
				<script type="text/javascript" src="../js.js"></script>
				<title>Problem 4048</title></head>
				<body><div id="hduoj_c"><tr><td align=center><h1 style='color:#1A5CC8'>Zhuge Liang's Stone Sentinel Maze</h1><font><b><span style='font-family:Arial;font-size:12px;font-weight:bold;color:green'>Time Limit: 10000/4000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 264&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 67<br></span></b></font><br><br><div class=panel_title align=left>Problem Description</div> <div class=panel_content><center><img src=../../data/images/4048-1.jpg></center> <br>Zhuge Liang was a chancellor of the state of Shu Han during the Three Kingdoms period of Chinese history. He is often recognized as the greatest and most accomplished strategist of his era. He was so smart that his name also means ¡°wise man¡± in Chinese.<br><br>One of Zhuge Liang¡¯s achievements in legend is the Stone Sentinel Maze. It was an array of rocks and boulders built to defend against enemies. The formation was located on Yufu Shore by the Yangtze River near present-day Baidicheng, Chongqing, China, where supposed ruins of the array exist.<br><br>In chapter 84 of the historical novel Romance of the Three Kingdoms, as Lu Xun neared Baidicheng, he felt a strong enemy presence in the area and alerted his army to a possible ambush. He sent scouts ahead, who reported that the region was deserted except for some scattered piles of rocks. The bewildered Lu Xun asked a local, who told him that qi (&quot;energy&quot;) started emerging from the area after Zhuge Liang arranged the rocks there. Lu Xun personally inspected the area and decided that the array was only a petty display of deception. Hence, Lu Xun led a few horsemen with him into the maze, and as he was about to exit, there was a strong gust of wind. At that moment, dust storms overshadowed the sky and the rocks appeared to become valleys; mountainous piles of dirt emerged and the roar of thunder rocked the skies while the waves of the nearby Yangtze River sounded like the clashing of swords and beating of war drums¡­<br><br>After the research on the Stone Sentinel Maze, scientists find some regulations. The rocks have m different kinds of weight (1&lt;=m&lt;=10,000). The weight of a rock is a positive integer not exceeding 10,000. There are n (3&lt;=n&lt;=100,000) rocks placed on a circle with equal spacing and the greatest common divisor of their weight is 1. They want to know in how many ways the rocks can be placed like that.<br><br>Notice:<br>1. Multiple rocks with the same weight can be placed on the circle.<br>2. If a solution will be the same as another one by rotation, these two solutions should be consider as the same.<br>3. The answer may be quite large. You just need to calculate the remainder of the answer when divided by 10,007.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Input</div> <div class=panel_content>The input begins with a line containing an integer T, the number of test cases.<br>For each case, the first line begins with two integers --- the above mentioned m and n. Then m lines follow, each containing a positive integer representing rock weight. It is guaranteed that these m integers are different.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Output</div> <div class=panel_content>For each case, output one integer in one line, representing the remainder of the number of ways when divided by 10,007.<br></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Input</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
2 3
2
3
3 3
6
10
15</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Sample Output</div><div class=panel_content><pre><div style="font-family:Courier New,Courier,monospace;">2
2</div></pre></div><div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Source</div> <div class=panel_content> <a href='/search.php?field=problem&key=The 36th ACM/ICPC Asia Regional Beijing Site ¡ª¡ª Online Contest &source=1&searchmode=source'> The 36th ACM/ICPC Asia Regional Beijing Site ¡ª¡ª Online Contest  </a> </div> <div class=panel_bottom>&nbsp;</div><br><div class=panel_title align=left>Recommend</div> <div class=panel_content>lcy</div><div class=panel_bottom>&nbsp;</div><br><center style='font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8'><a href='statistic.php?pid=4048'>Statistic</a>&nbsp;|&nbsp;<a href='submit.php?pid=4048'>Submit</a>&nbsp;|&nbsp;<a href="./discuss/problem/list.php?problemid=4048">Discuss</a> | <a href='note/note.php?pid=4048'>Note</a><br></td></tr></div></body></html>